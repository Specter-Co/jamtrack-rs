import lap
import numpy as np
import sys

def main(cost, thresh=0.5):
    cost, x, y = lap.lapjv(cost_matrix, extend_cost=True, cost_limit=float('inf'))
    print(cost, x, y) 



if __name__ == '__main__':
    # cost_matrix = np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9]])
    # main(cost_matrix)  


    cost_matrix = np.array([[1, 2, 3, 4],
                        [5, 6, 7, 8],
                        [9, 10, 11, 12],
                        [13, 14, 15, 16]])
    main(cost_matrix)  

    cost_matrix = np.array([
        [1., 2., 3., 4., 1.],
        [5., 6., 7., 8., 2.],
        [9., 10., 11., 12., 3.],
        [13., 14., 15., 16., 4.],
        [17., 18., 19., 20., 5.],
    ]
    )
    main(cost_matrix)
    cost_matrix = np.array([
        [
            0.84612522, 0.38549337, 0.27955776, 0.76146103, 0.85084611,
            0.02021263, 0.05006527, 0.40961263, 0.19081828, 0.26665063,
        ],
        [
            0.09142041, 0.39511703, 0.5287497, 0.43743945, 0.30997663,
            0.76304532, 0.37178294, 0.73159998, 0.59313334, 0.86550584,
        ],
        [
            0.03684529, 0.27024986, 0.1672481, 0.14402541, 0.76511803,
            0.94059419, 0.22349045, 0.51600746, 0.61480263, 0.6346781,
        ],
        [
            0.68874528, 0.98444085, 0.33925711, 0.83052401, 0.71814185,
            0.62298001, 0.76450538, 0.03825611, 0.50084776, 0.46314705,
        ],
        [
            0.05084691, 0.89486244, 0.87147786, 0.64935965, 0.72806465,
            0.05434427, 0.03566491, 0.73072368, 0.94922003, 0.01400043,
        ],
        [
            0.20976728, 0.50350434, 0.83373798, 0.15936914, 0.97320944,
            0.00213279, 0.72815469, 0.17278318, 0.87271939, 0.19039888,
        ],
        [
            0.24818255, 0.52879636, 0.22082257, 0.69962464, 0.85367808,
            0.0130662, 0.12319754, 0.01034406, 0.44409775, 0.31241999,
        ],
        [
            0.2413349, 0.91244109, 0.67805999, 0.84944587, 0.02873252,
            0.60521235, 0.06197102, 0.33353023, 0.01528123, 0.17659061,
        ],
        [
            0.84612522, 0.38549337, 0.27955776, 0.76146103, 0.85084611,
            0.02021263, 0.05006527, 0.40961263, 0.19081828, 0.26665063,
        ],
        [
            0.09142041, 0.39511703, 0.5287497, 0.43743945, 0.30997663,
            0.76304532, 0.37178294, 0.73159998, 0.59313334, 0.86550584,
        ],
    ])
    main(cost_matrix)

    
    cost_matrix = np.array([
        [
            0.84612522, 0.38549337, 0.27955776, 0.76146103, 0.85084611,
            0.02021263, 0.05006527, 0.40961263, 0.19081828, 0.26665063,
        ],
        [
            0.09142041, 0.39511703, 0.5287497, 0.43743945, 0.30997663,
            0.76304532, 0.37178294, 0.73159998, 0.59313334, 0.86550584,
        ],
        [
            0.03684529, 0.27024986, 0.1672481, 0.14402541, 0.76511803,
            0.94059419, 0.22349045, 0.51600746, 0.61480263, 0.6346781,
        ],
        [
            0.68874528, 0.98444085, 0.33925711, 0.83052401, 0.71814185,
            0.62298001, 0.76450538, 0.03825611, 0.50084776, 0.46314705,
        ],
        [
            0.05084691, 0.89486244, 0.87147786, 0.64935965, 0.72806465,
            0.05434427, 0.03566491, 0.73072368, 0.94922003, 0.01400043,
        ],
        [
            0.20976728, 0.50350434, 0.83373798, 0.15936914, 0.97320944,
            0.00213279, 0.72815469, 0.17278318, 0.87271939, 0.19039888,
        ],
        [
            0.24818255, 0.52879636, 0.22082257, 0.69962464, 0.85367808,
            0.0130662, 0.12319754, 0.01034406, 0.44409775, 0.31241999,
        ],
        [
            0.2413349, 0.91244109, 0.67805999, 0.84944587, 0.02873252,
            0.60521235, 0.06197102, 0.33353023, 0.01528123, 0.17659061,
        ]]
    )
    print(cost_matrix)
    main(cost_matrix)


    cost_matrix = np.array([
        [0.8461252450942993, 0.38549336791038513, 0.2795577645301819, 0.7614610195159912, 0.8508461117744446, 0.020212629809975624, 0.05006527155637741, 0.40961262583732605, 0.19081827998161316, 0.26665061712265015, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37],
        [0.09142041206359863, 0.39511704444885254, 0.5287497043609619, 0.4374394416809082, 0.30997663736343384, 0.7630453109741211, 0.37178292870521545, 0.7315999865531921, 0.5931333303451538, 0.8655058145523071, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37],
        [0.036845289170742035, 0.2702498733997345, 0.16724810004234314, 0.14402541518211365, 0.7651180028915405, 0.9405941963195801, 0.22349044680595398, 0.5160074830055237, 0.6148026585578918, 0.6346781253814697, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37],
        [0.6887452602386475, 0.9844408631324768, 0.3392571210861206, 0.8305240273475647, 0.7181418538093567, 0.622979998588562, 0.7645053863525391, 0.03825610876083374, 0.5008477568626404, 0.46314704418182373, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37],
        [0.05084690824151039, 0.8948624134063721, 0.8714778423309326, 0.6493596434593201, 0.7280646562576294, 0.05434427037835121, 0.03566490858793259, 0.7307236790657043, 0.9492200016975403, 0.014000429771840572, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37],
        [0.20976728200912476, 0.5035043358802795, 0.8337379693984985, 0.15936914086341858, 0.9732094407081604, 0.0021327899303287268, 0.728154718875885, 0.17278318107128143, 0.872719407081604, 0.19039888679981232, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37],
        [0.24818255007266998, 0.528796374797821, 0.22082257270812988, 0.6996246576309204, 0.8536781072616577, 0.013066199608147144, 0.123197540640831, 0.010344060137867928, 0.44409775733947754, 0.31241998076438904, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37],
        [0.24133490025997162, 0.912441074848175, 0.678059995174408, 0.8494458794593811, 0.02873251959681511, 0.6052123308181763, 0.061971019953489304, 0.3335302174091339, 0.015281230211257935, 0.17659060657024384, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37],
        [8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 8.5070586659632215e37, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    ])
    main(cost_matrix)